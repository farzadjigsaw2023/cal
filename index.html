<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
    <title>Gold & US30 Pro Calc</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
    /* --- Global Variables --- */
    :root {
        /* Layout & Basics */
        --bg-color: #f0f2f5;
        --card-bg: #ffffff;
        --text-color: #1c1e21;
        --input-bg: #f8f9fa;
        --border-color: #dee2e6;
        --label-color: #606770;
        
        /* Dynamic Theme Variables (Default: Gold) */
        --theme-primary: #FFD700; 
        --theme-gradient: linear-gradient(135deg, #FFD700, #DAA520);
        --table-header-bg: linear-gradient(45deg, #FFD700, #DAA520);
        --table-header-text: #000000;
        --active-btn-text: #000000;
        --focus-glow: rgba(218, 165, 32, 0.35);
        
        --result-bg: #fffbf0;
        --result-text: #b8860b;
        
        --btn-buy-bg: linear-gradient(45deg, #28a745, #218838);
        --btn-sell-bg: linear-gradient(45deg, #dc3545, #c82333);
    }

    /* Dark Mode */
    body.dark {
        --bg-color: #18191a;
        --card-bg: #242526;
        --text-color: #e4e6eb;
        --input-bg: #3a3b3c;
        --border-color: #3e4042;
        --label-color: #b0b3b8;
        
        --result-bg: #2a2b2c;
    }

    /* --- Reset & Layout --- */
    * { box-sizing: border-box; outline: none; }

    body {
        font-family: 'Poppins', sans-serif;
        /* ---------- CHANGED: new background with subtle texture ---------- */
        /* Keep var(--bg-color) for base (so dark mode still works), then add layered decorative gradients */
        background-color: var(--bg-color);
        background-image:
            /* soft diagonal top-left light overlay */
            linear-gradient(135deg, rgba(255,255,255,0.55) 0%, rgba(255,255,255,0.12) 30%, rgba(255,255,255,0) 60%),
            /* repeating fine diagonal lines for texture */
            repeating-linear-gradient(135deg, rgba(255,255,255,0.18) 0 1px, transparent 1px 8px);
        background-blend-mode: overlay, normal;
        background-attachment: fixed;
        color: var(--text-color);
        margin: 0;
        min-height: 100vh;
        display: flex; 
        justify-content: center;
        align-items: center;
        padding: 20px;
        transition: background 0.3s ease;
    }

    .container {
        background: var(--card-bg);
        width: 100%;
        max-width: 500px;
        padding: 35px 30px;
        border-radius: 20px;
        box-shadow: 0 15px 40px rgba(0,0,0,0.1);
        border: 1px solid var(--border-color);
        transition: all 0.3s ease;
    }

    /* --- Inputs (Spinner Removed) --- */
    input::-webkit-outer-spin-button,
    input::-webkit-inner-spin-button {
        -webkit-appearance: none;
        margin: 0;
    }
    input[type=number] {
        -moz-appearance: textfield;
    }

    input[type="number"] {
        width: 100%;
        padding: 15px;
        font-size: 16px;
        border-radius: 12px;
        border: 1.5px solid var(--border-color);
        background: var(--input-bg);
        color: var(--text-color);
        font-weight: 500;
        transition: all 0.2s;
        display: block;
    }

    input[type="number"]:focus {
        border-color: var(--theme-primary);
        box-shadow: 0 0 0 4px var(--focus-glow);
    }

    label {
        display: block;
        margin: 18px 0 8px;
        font-weight: 600;
        font-size: 15px;
        color: var(--label-color);
        text-align: left;
    }

    /* --- Selection Buttons --- */
    .row-group {
        display: flex;
        gap: 12px;
        margin-bottom: 5px;
    }

    .choice-btn {
        flex: 1;
        padding: 14px;
        font-size: 15px;
        font-weight: 600;
        border-radius: 12px;
        border: 1.5px solid var(--border-color);
        background: var(--input-bg);
        color: var(--label-color);
        cursor: pointer;
        transition: all 0.2s ease;
    }

    .choice-btn:hover {
        background: var(--border-color);
    }

    /* Active States */
    .choice-btn.active {
        background: var(--theme-gradient);
        color: var(--active-btn-text);
        border: none;
        box-shadow: 0 4px 15px var(--focus-glow);
        transform: translateY(-1px);
    }
    
    /* Specific Active Colors Overrides (Gold/Blue) */
    #btnXAUUSD.active {
        background: linear-gradient(135deg, #FFD700, #FDB931);
        color: #000000;
        box-shadow: 0 4px 15px rgba(255, 215, 0, 0.4);
    }
    #btnUS30.active {
        background: linear-gradient(135deg, #003366, #0056b3); 
        color: #ffffff;
        box-shadow: 0 4px 15px rgba(0, 51, 102, 0.4);
    }

    /* --- Action Buttons --- */
    .action-group {
        display: flex;
        gap: 15px;
        margin-top: 30px;
    }

    .action-btn {
        flex: 1;
        padding: 16px;
        font-size: 17px;
        font-weight: 700;
        color: white;
        border: none;
        border-radius: 12px;
        cursor: pointer;
        transition: transform 0.2s, box-shadow 0.2s;
        box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    }

    .btn-buy { background: var(--btn-buy-bg); }
    .btn-sell { background: var(--btn-sell-bg); }

    .action-btn:active { transform: scale(0.98); }
    .action-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 10px 25px rgba(0,0,0,0.15);
    }

    /* --- Result Area & Table --- */
    .result-card {
        width: 100%; 
        margin-top: 30px;
        background: var(--result-bg);
        padding: 0;
        border-radius: 16px;
        overflow: hidden;
        border: 1px solid rgba(0,0,0,0.05);
        box-shadow: 0 8px 20px rgba(0,0,0,0.08);
        display: none; 
        animation: fadeIn 0.3s ease-out;
    }

    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

    table { width: 100%; border-collapse: collapse; }
    
    /* Dynamic Header Style */
    th {
        background: var(--table-header-bg); /* Dynamic Background (Gold/Blue Gradient) */
        color: var(--table-header-text); /* Dynamic Text Color (Black/White) */
        padding: 15px;
        text-align: left;
        font-weight: 700; 
        font-size: 16px;
    }

    td {
        padding: 14px 15px;
        border-bottom: 1px solid rgba(0,0,0,0.05);
        color: var(--text-color);
        font-weight: 500;
        font-size: 16px;
    }
    
    tr:last-child td { border-bottom: none; }
    
    td:last-child { 
        text-align: right; 
        font-weight: 700; 
        color: var(--result-text); 
    }

    .profit-val { color: #28a745 !important; }
    .loss-val { color: #dc3545 !important; }

    /* --- Copy Icon --- */
    .copy-icon {
        width: 18px; height: 18px;
        cursor: pointer;
        fill: #adb5bd;
        transition: fill 0.2s;
        vertical-align: middle;
        margin-left: 8px;
        display: inline-block;
    }
    .copy-icon:hover { fill: var(--theme-primary); transform: scale(1.1); }

    /* --- Mobile Optimization --- */
    @media (max-width: 600px) {
        body { padding: 10px; align-items: flex-start; }
        .container {
            padding: 20px 15px;
            margin-top: 10px;
        }
    }
</style>
</head>
<body>

    <div class="container">
        <label></label>
        <div class="row-group">
            <button id="btnXAUUSD" class="choice-btn active" onclick="selectCurrency('XAUUSD')">XAUUSD</button>
            <button id="btnUS30" class="choice-btn" onclick="selectCurrency('US30')">US30</button>
        </div>
        <input type="hidden" id="currencyPair" value="XAUUSD">

        <label>Account Size ($)</label>
        <input type="number" id="forexAccountSize" inputmode="decimal">

        <label>Risk (%)</label>
        <div class="row-group">
            <button id="btnRisk1" class="choice-btn active" onclick="selectRisk(1)">1%</button>
            <button id="btnRisk05" class="choice-btn" onclick="selectRisk(0.5)">0.5%</button>
        </div>
        <input type="hidden" id="forexRiskPercent" value="1">

        <label>Entry Price</label>
        <input type="number" id="forexEntryPrice" inputmode="decimal">

        <label id="tpLabel" style="color:#28a745">TP (Pips)</label>
        <input type="number" id="forexTpPips" inputmode="decimal">

        <label id="slLabel" style="color:#dc3545">SL (Pips)</label>
        <input type="number" id="forexStopPips" inputmode="decimal">

        <div class="action-group">
            <button class="action-btn btn-sell" onclick="calculateForex('short')">Sell</button>
            <button class="action-btn btn-buy" onclick="calculateForex('long')">Buy</button>
        </div>

        <div id="output" class="result-card"></div>
    </div>

    <script>
        // --- Helper: Copy to Clipboard ---
        function copyText(txt, btn) {
            navigator.clipboard.writeText(txt);
            let original = btn.innerHTML;
            btn.innerHTML = `<svg viewBox="0 0 24 24" width="18" height="18" fill="#28a745"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg>`;
            setTimeout(() => btn.innerHTML = original, 1500);
        }

        // --- Theme Manager ---
        function setTheme(pair) {
            const r = document.documentElement.style;
            
            if (pair === 'XAUUSD') {
                // Gold Theme
                r.setProperty('--theme-primary', '#FFD700');
                r.setProperty('--theme-gradient', 'linear-gradient(135deg, #FFD700, #DAA520)');
                r.setProperty('--table-header-bg', 'linear-gradient(45deg, #FFD700, #DAA520)');
                r.setProperty('--table-header-text', '#000000');
                r.setProperty('--active-btn-text', '#000000');
                r.setProperty('--result-text', '#b8860b');
                r.setProperty('--focus-glow', 'rgba(218, 165, 32, 0.35)');
            } else { 
                // US30 Blue Theme
                r.setProperty('--theme-primary', '#0056b3');
                r.setProperty('--theme-gradient', 'linear-gradient(135deg, #003366, #0056b3)');
                r.setProperty('--table-header-bg', 'linear-gradient(45deg, #003366, #0056b3)');
                r.setProperty('--table-header-text', '#ffffff');
                r.setProperty('--active-btn-text', '#ffffff');
                r.setProperty('--result-text', '#007bff');
                r.setProperty('--focus-glow', 'rgba(0, 86, 179, 0.35)');
            }
        }

        // --- Selection Logic ---
        function selectCurrency(pair) {
            document.querySelectorAll('.currency-button, .choice-btn').forEach(b => {
                if(b.id.includes('XAU') || b.id.includes('US30')) b.classList.remove('active');
            });
            document.getElementById(`btn${pair}`).classList.add('active');
            document.getElementById('currencyPair').value = pair;
            
            const suffix = pair === 'US30' ? '(Points)' : '(Pips)';
            document.getElementById('tpLabel').textContent = `TP ${suffix}`;
            document.getElementById('slLabel').textContent = `SL ${suffix}`;
            
            setTheme(pair);
        }

        function selectRisk(val) {
            document.getElementById('btnRisk1').classList.remove('active');
            document.getElementById('btnRisk05').classList.remove('active');
            document.getElementById(val === 1 ? 'btnRisk1' : 'btnRisk05').classList.add('active');
            document.getElementById('forexRiskPercent').value = val;
        }

        // --- Core Calculation with Test Mode ---
        function calculateForex(tradeType) {
            const pair = document.getElementById('currencyPair').value;
            let accountSize = parseFloat(document.getElementById('forexAccountSize').value);
            const riskPercent = parseFloat(document.getElementById('forexRiskPercent').value);
            let entryPrice = parseFloat(document.getElementById('forexEntryPrice').value);
            let slPips = parseFloat(document.getElementById('forexStopPips').value);
            let tpPips = parseFloat(document.getElementById('forexTpPips').value);
            
            setTheme(pair); 
            
            const out = document.getElementById('output');
            out.style.display = 'block';

            // --- TEST MODE / AUTO-FILL LOGIC ---
            const isGold = pair === 'XAUUSD';
            const defaultEntry = isGold ? 2300.00 : 39000.00;
            const defaultSL = isGold ? 40 : 50;
            const defaultTP = isGold ? 80 : 100;
            
            if (!accountSize || accountSize <= 0) {
                accountSize = 10000;
                // Since the user removed the placeholder, we don't auto-fill unless they calculate
                // document.getElementById('forexAccountSize').value = accountSize;
            }
            
            if (!entryPrice || entryPrice <= 0) {
                entryPrice = defaultEntry;
                document.getElementById('forexEntryPrice').value = entryPrice;
            }
            
            if (!slPips || slPips <= 0) {
                slPips = defaultSL;
                document.getElementById('forexStopPips').value = slPips;
            }

            if (!tpPips || tpPips <= 0) {
                tpPips = defaultTP;
                document.getElementById('forexTpPips').value = tpPips;
            }
            // --- END TEST MODE / AUTO-FILL LOGIC ---

            const config = isGold 
                ? { pipSize: 0.1, contractSize: 100, precision: 2 }
                : { pipSize: 1.0, contractSize: 1, precision: 1 };

            const valuePerPipPerLot = config.contractSize * config.pipSize;
            const riskAmount = accountSize * (riskPercent / 100);
            const lots = riskAmount / (slPips * valuePerPipPerLot);
            
            const slDist = slPips * config.pipSize;
            const tpDist = tpPips * config.pipSize;

            const slPrice = tradeType === 'long' ? entryPrice - slDist : entryPrice + slDist;
            const tpPrice = tradeType === 'long' ? entryPrice + tpDist : entryPrice - tpDist;
            
            const profit = riskAmount * (tpPips / slPips);
            const rr = (tpPips / slPips).toFixed(2);

            const copyIcon = (val) => `<span class="copy-icon" onclick="copyText('${val}', this)"><svg viewBox="0 0 24 24" width="100%" height="100%"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg></span>`;
            
            const html = `
            <table>
                <thead>
                    <tr>
                        <th colspan="2">${tradeType.toUpperCase()} POSITION  ${pair.toUpperCase()}</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td>Lot Size</td><td>${lots.toFixed(2)} ${copyIcon(lots.toFixed(2))}</td></tr>
                    <tr><td>TP Price</td><td>${tpPrice.toFixed(config.precision)} ${copyIcon(tpPrice.toFixed(config.precision))}</td></tr>
                    <tr><td>SL Price</td><td>${slPrice.toFixed(config.precision)} ${copyIcon(slPrice.toFixed(config.precision))}</td></tr>
                    <tr><td>Profit</td><td class="profit-val">+$${profit.toFixed(2)}</td></tr>
                    <tr><td>Loss</td><td class="loss-val">-$${riskAmount.toFixed(2)}</td></tr>
                    <tr><td>Risk : Reward</td><td>1 : ${rr}</td></tr>
                </tbody>
            </table>`;

            out.innerHTML = html;
            out.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        // Init
        document.addEventListener('DOMContentLoaded', () => {
            selectCurrency('XAUUSD'); // Default Gold
            selectRisk(1);
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                document.body.classList.add('dark');
            }
        });
    </script>
</body>
</html>
